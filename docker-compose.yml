version: "3.8"

services:
  mc:
    image: itzg/minecraft-server
    tty: true
    stdin_open: true
    ports:
      - "25565:25565"
    environment:
      EULA: "TRUE"
      TYPE: "PAPER"
      VERSION: "1.20.1"
      PLUGINS_FILE: "/extras/plugins.txt"
      ENABLE_AUTOSTOP: "TRUE"
      # More aggressive settings for demo purposes
      AUTOSTOP_TIMEOUT_INIT: "900"
      AUTOSTOP_TIMEOUT_EST: "600"
      MEMORY: "3G"
      JVM_OPTS: "-javaagent:/data/authlib-injector.jar=https://mcskin.com.cn/api/yggdrasil"
    volumes:
      # attach the relative directory 'data' to the container's /data path
      - ./data:/data
      - ./plugins.txt:/extras/plugins.txt:ro
      - ./plugins:/plugins
      - ./authlib-injector-1.2.4.jar:/data/authlib-injector.jar:ro